O(n!) time, where n is the size of the map.
O(n) space on the stack, where n is the size of the map.
